parameters:
    - name: profileName
      type: string

steps:
    - task: AzureCLI@2
      inputs:
          azureSubscription: $(subscription) # This is the devops service connection name
          scriptType: 'bash'
          scriptLocation: 'inlineScript'
          inlineScript: |
              # Purge all content from the CDN endpoint
              az cdn endpoint purge --profile-name ${{ parameters.profileName }} --name ${{ parameters.profileName }}.azureedge.net --content-paths "/*" --no-wait
      displayName: 'Purge CDN Cache'
